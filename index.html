<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>联机猜数字游戏</title>
</head>

<body>
    <h1>联机猜数字游戏</h1>
    <div id="roomActions">
        <input type="text" id="roomName" placeholder="房间名">
        <button onclick="createRoom()">创建房间</button>
        <button onclick="joinRoom()">加入房间</button>
    </div>
    <div id="gameArea" style="display: none;">
        <h2>游戏房间</h2>
        <div id="messages"></div>
        <input type="number" id="guessInput" placeholder="猜数字">
        <button onclick="makeGuess()">猜</button>
        <div id="turnInfo"></div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let roomName;

        function createRoom() {
            roomName = document.getElementById('roomName').value;
            socket.emit('createRoom', roomName);
        }

        function joinRoom() {
            roomName = document.getElementById('roomName').value;
            socket.emit('joinRoom', roomName);
        }

        socket.on('roomCreated', (room) => {
            roomName = room;
            document.getElementById('roomActions').style.display = 'none';
            document.getElementById('gameArea').style.display = 'block';
        });

        socket.on('roomExists', (room) => {
            alert(`房间 ${room} 已存在`);
        });

        socket.on('roomNotFound', (room) => {
            alert(`房间 ${room} 不存在`);
        });

        socket.on('playerJoined', (playerId) => {
            const messagesDiv = document.getElementById('messages');
            const p = document.createElement('p');
            p.textContent = `玩家 ${playerId} 加入了房间`;
            messagesDiv.appendChild(p);
        });

        function makeGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            socket.emit('guess', roomName, guess);
        }

        socket.on('message', (msg) => {
            const messagesDiv = document.getElementById('messages');
            const p = document.createElement('p');
            p.textContent = msg;
            messagesDiv.appendChild(p);
        });

        socket.on('gameOver', (msg) => {
            const messagesDiv = document.getElementById('messages');
            const p = document.createElement('p');
            p.textContent = msg;
            messagesDiv.appendChild(p);
            document.getElementById('guessInput').disabled = true;
        });

        socket.on('turnChanged', (playerId) => {
            const turnInfoDiv = document.getElementById('turnInfo');
            turnInfoDiv.textContent = `轮到玩家 ${playerId} 猜数字`;
        });
    </script>
</body>

</html>
