<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>云手机模拟器挂机游戏</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 0;
            margin: 0;
        }
        .container {
            max-width: 100%;
            padding: 10px;
        }
        .header {
            background-color: #4CAF50;
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: 0 0 10px 10px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .card-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #4CAF50;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }
        .btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 5px;
            width: 100%;
        }
        .btn-small {
            padding: 5px 10px;
            font-size: 14px;
        }
        .btn-blue {
            background-color: #2196F3;
        }
        .btn-orange {
            background-color: #FF9800;
        }
        .btn-red {
            background-color: #F44336;
        }
        .btn-purple {
            background-color: #9C27B0;
        }
        .btn-vip {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
        }
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .stat-item {
            flex: 1;
            text-align: center;
            padding: 5px;
        }
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #4CAF50;
        }
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .task-info {
            flex: 1;
        }
        .task-reward {
            color: #4CAF50;
            font-weight: bold;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .tab-container {
            display: none;
        }
        .tab-container.active {
            display: block;
        }
        .nav-tabs {
            display: flex;
            list-style: none;
            margin-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }
        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            cursor: pointer;
        }
        .nav-tab.active {
            border-bottom: 2px solid #4CAF50;
            color: #4CAF50;
            font-weight: bold;
        }
        .modal {
            display: block; /* 修改为默认显示登录模态框 */
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .alert {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        .alert-success {
            background-color: #dff0d8;
            color: #3c763d;
        }
        .alert-danger {
            background-color: #f2dede;
            color: #a94442;
        }
        .progress-bar {
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.3s;
        }
        .badge {
            display: inline-block;
            padding: 3px 6px;
            background-color: #4CAF50;
            color: white;
            border-radius: 3px;
            font-size: 12px;
            margin-left: 5px;
        }
        .badge-blue {
            background-color: #2196F3;
        }
        .badge-orange {
            background-color: #FF9800;
        }
        .badge-purple {
            background-color: #9C27B0;
        }
        .badge-vip {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
        }
        .simulator-status {
            font-size: 12px;
            color: #666;
        }
        .status-online {
            color: #4CAF50;
        }
        .status-offline {
            color: #F44336;
        }
        .status-working {
            color: #FF9800;
        }
        .status-boosted {
            color: #9C27B0;
        }
        .language-selector {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 100;
        }
        .vip-benefits {
            background: linear-gradient(45deg, #FFF8E1, #FFECB3);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 语言选择器 -->
        <div class="language-selector">
            <select id="languageSelect" onchange="changeLanguage()">
                <option value="zh">中文</option>
                <option value="en">English</option>
            </select>
        </div>

        <div class="header">
            <h1 id="appTitle">云手机模拟器</h1>
            <p id="userInfo">未登录</p>
        </div>

        <!-- 登录/注册模态框 -->
        <div id="loginModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('loginModal')">&times;</span>
                <h2 id="loginTitle">登录/注册</h2>
                <div id="loginAlert" class="alert" style="display: none;"></div>
                <div class="form-group">
                    <input type="tel" id="loginPhone" class="form-control" placeholder="请输入手机号码" maxlength="11">
                </div>
                <div class="form-group">
                    <input type="password" id="loginPassword" class="form-control" placeholder="请输入密码">
                </div>
                <button onclick="login()" class="btn" id="loginBtn">登录</button>
                <button onclick="showRegister()" class="btn btn-blue" id="registerBtn">注册新账号</button>
                <button onclick="quickLogin()" class="btn btn-orange" id="quickLoginBtn">快速体验</button>
            </div>
        </div>

        <!-- 注册模态框 -->
        <div id="registerModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeModal('registerModal')">&times;</span>
                <h2 id="registerTitle">注册新账号</h2>
                <div id="registerAlert" class="alert" style="display: none;"></div>
                <div class="form-group">
                    <input type="tel" id="registerPhone" class="form-control" placeholder="请输入手机号码" maxlength="11">
                </div>
                <div class="form-group">
                    <input type="password" id="registerPassword" class="form-control" placeholder="请输入密码(至少6位)">
                </div>
                <div class="form-group">
                    <input type="password" id="registerPassword2" class="form-control" placeholder="请再次输入密码">
                </div>
                <div class="form-group">
                    <input type="text" id="inviteCode" class="form-control" placeholder="邀请码(选填)">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="agreeTerms"> <span id="agreeTermsText">我已阅读并同意《用户协议》和《隐私政策》</span>
                    </label>
                </div>
                <button onclick="register()" class="btn" id="registerSubmitBtn">立即注册</button>
            </div>
        </div>

        <!-- 绑定支付宝模态框 -->
        <div id="alipayModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeModal('alipayModal')">&times;</span>
                <h2 id="alipayTitle">绑定支付宝</h2>
                <div id="alipayAlert" class="alert" style="display: none;"></div>
                <div class="form-group">
                    <input type="text" id="alipayAccount" class="form-control" placeholder="支付宝账号">
                </div>
                <div class="form-group">
                    <input type="text" id="alipayName" class="form-control" placeholder="支付宝实名姓名">
                </div>
                <button onclick="bindAlipay()" class="btn" id="bindAlipaySubmitBtn">确认绑定</button>
                <p style="font-size: 12px; color: #666; margin-top: 10px;" id="alipayNote">注意：每个支付宝账号只能绑定一个游戏账号</p>
            </div>
        </div>

        <!-- 主内容区域 -->
        <div id="mainContent" style="display: none;">
            <ul class="nav-tabs">
                <li class="nav-tab active" onclick="switchTab('home')" id="homeTabBtn">首页</li>
                <li class="nav-tab" onclick="switchTab('tasks')" id="tasksTabBtn">任务中心</li>
                <li class="nav-tab" onclick="switchTab('withdraw')" id="withdrawTabBtn">提现中心</li>
                <li class="nav-tab" onclick="switchTab('profile')" id="profileTabBtn">我的</li>
                <li class="nav-tab" onclick="switchTab('shop')" id="shopTabBtn">商城</li>
            </ul>

            <!-- 首页 -->
            <div id="homeTab" class="tab-container active">
                <div class="card">
                    <div class="card-title">实时收益展示</div>
                    <div id="userStats"></div>
                    <div class="progress-bar">
                        <div id="earningProgress" class="progress"></div>
                    </div>
                    <p id="nextEarning">下次收益: <span id="nextEarningTime">60</span>秒</p>
                </div>

                <div class="card">
                    <div class="card-title">项目共享 <span class="badge">热</span></div>
                    <div class="task-item">
                        <div class="task-info">一键拉新日赚500</div>
                        <button class="btn btn-small btn-blue" onclick="joinProject(1)" id="joinProject1Btn">加入</button>
                    </div>
                    <div class="task-item">
                        <div class="task-info">AI慧算宝简单分红 <span class="badge badge-blue">新</span></div>
                        <button class="btn btn-small btn-blue" onclick="joinProject(2)" id="joinProject2Btn">加入</button>
                    </div>
                    <div class="task-item">
                        <div class="task-info">视频号挂机每天50~100 <span class="badge badge-orange">推荐</span></div>
                        <button class="btn btn-small btn-blue" onclick="joinProject(3)" id="joinProject3Btn">加入</button>
                    </div>
                </div>

                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="simulatorCount">0</div>
                        <div class="stat-label" id="simulatorLabel">模拟器数量</div>
                        <button class="btn btn-small" onclick="upgradeAgent()" id="upgradeAgentBtn">升级代理</button>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="checkinStatus">未签到</div>
                        <div class="stat-label" id="checkinLabel">签到状态</div>
                        <button class="btn btn-small" onclick="dailyCheckin()" id="checkinBtn">点击签到</button>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="todayEarnings">0</div>
                        <div class="stat-label" id="todayEarningsLabel">今日金币</div>
                        <button class="btn btn-small" onclick="switchTab('withdraw')" id="viewEarningsBtn">查看收益</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">我的模拟器 <span class="badge" id="onlineSimulators">0/0在线</span></div>
                    <div id="simulatorList"></div>
                    <button class="btn" onclick="addSimulator()" id="addSimulatorBtn">添加云手机模拟器</button>
                    <button class="btn btn-orange" onclick="optimizeSimulators()" id="optimizeBtn">一键优化</button>
                    <!-- 新增：模拟器加速按钮 -->
                    <button class="btn btn-purple" onclick="boostSimulators()" id="boostBtn">加速模拟器(1小时)</button>
                </div>

                <div class="card">
                    <div class="card-title">活动中心 <span class="badge badge-purple">活动</span></div>
                    <div class="task-item">
                        <div class="task-info">新手礼包 - 注册即送1个模拟器</div>
                        <div class="task-reward">+1模拟器</div>
                    </div>
                    <div class="task-item">
                        <div class="task-info">连续签到7天奖励</div>
                        <div class="task-reward">+5元</div>
                    </div>
                    <div class="task-item">
                        <div class="task-info">邀请好友得现金</div>
                        <div class="task-reward">最高+100元</div>
                        <button class="btn btn-small" onclick="showInvite()" id="inviteBtn">去邀请</button>
                    </div>
                </div>

                <!-- 新增：VIP会员专区 -->
                <div class="card" id="vipSection">
                    <div class="card-title">VIP会员专区 <span class="badge badge-vip">VIP</span></div>
                    <div class="vip-benefits">
                        <p><strong>VIP特权:</strong></p>
                        <ul>
                            <li>所有模拟器收益+50%</li>
                            <li>每日签到奖励翻倍</li>
                            <li>专属VIP任务</li>
                            <li>提现免手续费</li>
                        </ul>
                    </div>
                    <button class="btn btn-vip" onclick="purchaseVIP()" id="purchaseVipBtn">开通VIP会员 (30元/月)</button>
                </div>
            </div>

            <!-- 任务中心 -->
            <div id="tasksTab" class="tab-container">
                <div class="card">
                    <div class="card-title">日常任务 <span class="badge">每日刷新</span></div>
                    <div id="taskList"></div>
                    <!-- 新增：任务自动完成开关 -->
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="autoCompleteTasks" onchange="toggleAutoCompleteTasks()"> 
                            <span id="autoCompleteLabel">自动完成任务</span>
                        </label>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">推广任务 <span class="badge badge-orange">高收益</span></div>
                    <div class="task-item">
                        <div class="task-info">邀请好友注册</div>
                        <div class="task-reward">+1模拟器</div>
                        <button class="btn btn-small" onclick="showInvite()">去邀请</button>
                    </div>
                    <div class="task-item">
                        <div class="task-info">好友首次完成任务</div>
                        <div class="task-reward">+3元</div>
                    </div>
                    <div class="task-item">
                        <div class="task-info">好友达到10个模拟器</div>
                        <div class="task-reward">+10元</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">高级任务 <span class="badge badge-blue">VIP</span></div>
                    <div class="task-item">
                        <div class="task-info">游戏试玩30分钟</div>
                        <div class="task-reward">+5元</div>
                        <button class="btn btn-small" onclick="startAdvancedTask(1)">开始</button>
                    </div>
                    <div class="task-item">
                        <div class="task-info">APP体验1小时</div>
                        <div class="task-reward">+8元</div>
                        <button class="btn btn-small" onclick="startAdvancedTask(2)">开始</button>
                    </div>
                    <div class="task-item">
                        <div class="task-info">问卷调查10分钟</div>
                        <div class="task-reward">+3元</div>
                        <button class="btn btn-small" onclick="startAdvancedTask(3)">开始</button>
                    </div>
                    <!-- 新增：VIP专属任务 -->
                    <div class="task-item" id="vipTask" style="display: none;">
                        <div class="task-info">VIP专属任务 - 观看广告</div>
                        <div class="task-reward">+15元</div>
                        <button class="btn btn-small btn-vip" onclick="startVipTask()">开始</button>
                    </div>
                </div>
            </div>

            <!-- 提现中心 -->
            <div id="withdrawTab" class="tab-container">
                <div class="card">
                    <div class="card-title">我的收益</div>
                    <div id="earningsStats"></div>
                </div>

                <div class="card">
                    <div class="card-title">提现申请 <span class="badge">实时到账</span></div>
                    <div class="form-group">
                        <select id="withdrawAmount" class="form-control">
                            <option value="10">10元</option>
                            <option value="30">30元</option>
                            <option value="50">50元</option>
                            <option value="100">100元</option>
                        </select>
                    </div>
                    <button class="btn" onclick="withdraw()" id="withdrawBtn">申请提现</button>
                    <p style="font-size: 12px; color: #666; margin-top: 10px;" id="withdrawTime">提现时间: 每日20:00-24:00</p>
                </div>

                <div class="card">
                    <div class="card-title">提现记录</div>
                    <div id="withdrawHistory"></div>
                </div>

                <div class="card">
                    <div class="card-title">金币兑换 <span class="badge badge-orange">1元=10000金币</span></div>
                    <div class="form-group">
                        <input type="number" id="exchangeGold" class="form-control" placeholder="输入兑换金币数量" min="10000" step="1000">
                    </div>
                    <button class="btn" onclick="exchangeGold()" id="exchangeBtn">兑换现金</button>
                </div>
            </div>

            <!-- 个人中心 -->
            <div id="profileTab" class="tab-container">
                <div class="card">
                    <div class="card-title">账号信息</div>
                    <div id="accountInfo"></div>
                    <button class="btn" onclick="logout()" id="logoutBtn">退出登录</button>
                </div>

                <div class="card">
                    <div class="card-title">支付宝绑定</div>
                    <div id="alipayInfo"></div>
                    <button class="btn" onclick="showAlipayModal()" id="bindAlipayBtn">绑定支付宝</button>
                </div>

                <div class="card">
                    <div class="card-title">推广中心 <span class="badge">赚钱</span></div>
                    <div id="inviteInfo"></div>
                    <button class="btn" onclick="showInvite()">邀请好友</button>
                    <button class="btn btn-blue" onclick="viewTeam()">查看团队</button>
                </div>

                <div class="card">
                    <div class="card-title">签到日历</div>
                    <div id="checkinCalendar"></div>
                    <!-- 新增：签到奖励翻倍卡 -->
                    <button class="btn btn-orange" onclick="useCheckinBoost()" id="checkinBoostBtn">使用签到翻倍卡</button>
                </div>

                <div class="card">
                    <div class="card-title">系统设置</div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="autoCheckin"> <span id="autoCheckinLabel">自动签到</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="autoWithdraw"> <span id="autoWithdrawLabel">自动提现(满10元)</span>
                        </label>
                    </div>
                    <button class="btn btn-small" onclick="saveSettings()" id="saveSettingsBtn">保存设置</button>
                </div>
            </div>

            <!-- 商城 -->
            <div id="shopTab" class="tab-container">
                <div class="card">
                    <div class="card-title">模拟器商城 <span class="badge">热卖</span></div>
                    <div class="task-item">
                        <div class="task-info">普通模拟器</div>
                        <div class="task-info">收益: 1金币/分钟</div>
                        <div class="task-reward">10元/个</div>
                        <button class="btn btn-small" onclick="buySimulator(1)">购买</button>
                    </div>
                    <div class="task-item">
                        <div class="task-info">高级模拟器 <span class="badge badge-blue">推荐</span></div>
                        <div class="task-info">收益: 2金币/分钟</div>
                        <div class="task-reward">18元/个</div>
                        <button class="btn btn-small" onclick="buySimulator(2)">购买</button>
                    </div>
                    <div class="task-item">
                        <div class="task-info">VIP模拟器 <span class="badge badge-purple">热销</span></div>
                        <div class="task-info">收益: 5金币/分钟</div>
                        <div class="task-reward">40元/个</div>
                        <button class="btn btn-small" onclick="buySimulator(3)">购买</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">特权卡 <span class="badge badge-orange">限时</span></div>
                    <div class="task-item">
                        <div class="task-info">周卡</div>
                        <div class="task-info">所有模拟器收益+20%</div>
                        <div class="task-reward">15元</div>
                        <button class="btn btn-small" onclick="buyCard(1)">购买</button>
                    </div>
                    <div class="task-item">
                        <div class="task-info">月卡 <span class="badge">超值</span></div>
                        <div class="task-info">所有模拟器收益+30%</div>
                        <div class="task-reward">50元</div>
                        <button class="btn btn-small" onclick="buyCard(2)">购买</button>
                    </div>
                    <div class="task-item">
                        <div class="task-info">季卡</div>
                        <div class="task-info">所有模拟器收益+50%</div>
                        <div class="task-reward">120元</div>
                        <button class="btn btn-small" onclick="buyCard(3)">购买</button>
                    </div>
                    <!-- 新增：签到奖励翻倍卡 -->
                    <div class="task-item">
                        <div class="task-info">签到翻倍卡</div>
                        <div class="task-info">下次签到奖励翻倍</div>
                        <div class="task-reward">8元</div>
                        <button class="btn btn-small" onclick="buyCheckinBoost()">购买</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">我的道具</div>
                    <div id="myItems"></div>
                </div>
            </div>
        </div>

        <!-- 邀请好友模态框 -->
        <div id="inviteModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeModal('inviteModal')">&times;</span>
                <h2>邀请好友</h2>
                <p>每邀请1位好友，您将获得1个模拟器</p>
                <div class="form-group">
                    <label>您的邀请码</label>
                    <input type="text" id="myInviteCode" class="form-control" readonly>
                </div>
                <div class="form-group">
                    <label>邀请链接</label>
                    <input type="text" id="inviteLink" class="form-control" readonly>
                </div>
                <button class="btn" onclick="copyInviteLink()">复制链接</button>
                <button class="btn btn-blue" onclick="shareInvite()">分享好友</button>
                <p style="font-size: 12px; color: #666; margin-top: 10px;">好友注册时填写您的邀请码，双方都能获得奖励</p>
            </div>
        </div>

        <!-- 团队查看模态框 -->
        <div id="teamModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeModal('teamModal')">&times;</span>
                <h2>我的团队</h2>
                <div id="teamList"></div>
                <p style="font-size: 12px; color: #666; margin-top: 10px;">团队总人数: <span id="teamCount">0</span>人</p>
                <p style="font-size: 12px; color: #666;">团队总收益: <span id="teamEarnings">0</span>元</p>
            </div>
        </div>

        <!-- 高级任务模态框 -->
        <div id="advancedTaskModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeAdvancedTask()">&times;</span>
                <h2 id="advancedTaskTitle">高级任务</h2>
                <div class="progress-bar">
                    <div id="taskProgress" class="progress"></div>
                </div>
                <p id="taskRemainingTime">剩余时间: <span id="taskTime">00:00</span></p>
                <div id="taskInstructions"></div>
                <button class="btn" id="taskCompleteBtn" style="display:none;" onclick="completeAdvancedTask()">领取奖励</button>
                <button class="btn btn-red" id="taskCancelBtn" onclick="cancelAdvancedTask()">取消任务</button>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let currentUser = null;
        let tasks = [
            { id: 1, name: "快手视频点赞", reward: 100, time: 1, completed: false },
            { id: 2, name: "观看短视频", reward: 50, time: 0.5, completed: false },
            { id: 3, name: "游戏试玩", reward: 500, time: 10, completed: false },
            { id: 4, name: "悬赏任务", reward: 300, time: 5, completed: false }
        ];
        
        let advancedTasks = [
            { id: 1, name: "游戏试玩30分钟", reward: 50000, time: 30, instructions: "请打开游戏并试玩30分钟，期间请不要关闭页面" },
            { id: 2, name: "APP体验1小时", reward: 80000, time: 60, instructions: "请下载并体验指定APP1小时" },
            { id: 3, name: "问卷调查10分钟", reward: 30000, time: 10, instructions: "请认真填写问卷调查，预计需要10分钟" }
        ];
        
        let shopItems = [
            { id: 1, name: "普通模拟器", price: 10, type: "simulator", value: 1 },
            { id: 2, name: "高级模拟器", price: 18, type: "simulator", value: 2 },
            { id: 3, name: "VIP模拟器", price: 40, type: "simulator", value: 5 },
            { id: 4, name: "周卡", price: 15, type: "card", value: 0.2, duration: 7 },
            { id: 5, name: "月卡", price: 50, type: "card", value: 0.3, duration: 30 },
            { id: 6, name: "季卡", price: 120, type: "card", value: 0.5, duration: 90 },
            { id: 7, name: "签到翻倍卡", price: 8, type: "boost", subtype: "checkin" }
        ];
        
        // 模拟数据库
        let users = [];
        let alipayBindings = [];
        let withdrawHistory = [];
        let currentAdvancedTask = null;
        let taskInterval = null;
        let earningInterval = null;
        let countdownInterval = null;
        let nextEarningTime = 60;
        let autoCompleteTasks = false;
        let simulatorBoostEndTime = null;
        let currentLanguage = 'zh';
        
        // 多语言支持
        const translations = {
            zh: {
                appTitle: "云手机模拟器",
                loginTitle: "登录/注册",
                loginBtn: "登录",
                registerBtn: "注册新账号",
                quickLoginBtn: "快速体验",
                registerTitle: "注册新账号",
                agreeTermsText: "我已阅读并同意《用户协议》和《隐私政策》",
                registerSubmitBtn: "立即注册",
                alipayTitle: "绑定支付宝",
                bindAlipaySubmitBtn: "确认绑定",
                alipayNote: "注意：每个支付宝账号只能绑定一个游戏账号",
                homeTabBtn: "首页",
                tasksTabBtn: "任务中心",
                withdrawTabBtn: "提现中心",
                profileTabBtn: "我的",
                shopTabBtn: "商城",
                joinProject1Btn: "加入",
                joinProject2Btn: "加入",
                joinProject3Btn: "加入",
                simulatorLabel: "模拟器数量",
                upgradeAgentBtn: "升级代理",
                checkinLabel: "签到状态",
                checkinBtn: "点击签到",
                todayEarningsLabel: "今日金币",
                viewEarningsBtn: "查看收益",
                addSimulatorBtn: "添加云手机模拟器",
                optimizeBtn: "一键优化",
                boostBtn: "加速模拟器(1小时)",
                inviteBtn: "去邀请",
                purchaseVipBtn: "开通VIP会员 (30元/月)",
                autoCompleteLabel: "自动完成任务",
                withdrawBtn: "申请提现",
                withdrawTime: "提现时间: 每日20:00-24:00",
                exchangeBtn: "兑换现金",
                logoutBtn: "退出登录",
                checkinBoostBtn: "使用签到翻倍卡",
                autoCheckinLabel: "自动签到",
                autoWithdrawLabel: "自动提现(满10元)",
                saveSettingsBtn: "保存设置"
            },
            en: {
                appTitle: "Cloud Phone Simulator",
                loginTitle: "Login/Register",
                loginBtn: "Login",
                registerBtn: "Register",
                quickLoginBtn: "Quick Experience",
                registerTitle: "Register New Account",
                agreeTermsText: "I agree to the Terms of Service and Privacy Policy",
                registerSubmitBtn: "Register Now",
                alipayTitle: "Bind Alipay",
                bindAlipaySubmitBtn: "Confirm Binding",
                alipayNote: "Note: Each Alipay account can only be bound to one game account",
                homeTabBtn: "Home",
                tasksTabBtn: "Tasks",
                withdrawTabBtn: "Withdraw",
                profileTabBtn: "Profile",
                shopTabBtn: "Shop",
                joinProject1Btn: "Join",
                joinProject2Btn: "Join",
                joinProject3Btn: "Join",
                simulatorLabel: "Simulators",
                upgradeAgentBtn: "Upgrade Agent",
                checkinLabel: "Check-in Status",
                checkinBtn: "Check-in",
                todayEarningsLabel: "Today's Coins",
                viewEarningsBtn: "View Earnings",
                addSimulatorBtn: "Add Simulator",
                optimizeBtn: "Optimize All",
                boostBtn: "Boost Simulators (1h)",
                inviteBtn: "Invite Friends",
                purchaseVipBtn: "Purchase VIP (¥30/month)",
                autoCompleteLabel: "Auto Complete Tasks",
                withdrawBtn: "Withdraw",
                withdrawTime: "Withdrawal Time: Daily 20:00-24:00",
                exchangeBtn: "Exchange Coins",
                logoutBtn: "Logout",
                checkinBoostBtn: "Use Check-in Boost",
                autoCheckinLabel: "Auto Check-in",
                autoWithdrawLabel: "Auto Withdraw (≥¥10)",
                saveSettingsBtn: "Save Settings"
            }
        };
        
        // 初始化函数
        function init() {
            // 检查URL中的邀请码
            const urlParams = new URLSearchParams(window.location.search);
            const inviteCode = urlParams.get('invite');
            if (inviteCode) {
                document.getElementById('inviteCode').value = inviteCode;
            }
            
            // 检查本地存储中是否有用户数据
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUI();
                document.getElementById('mainContent').style.display = 'block';
                document.getElementById('loginModal').style.display = 'none';
                startEarningInterval();
            } else {
                document.getElementById('loginModal').style.display = 'block';
            }
            
            // 初始化任务列表
            renderTaskList();
            renderCheckinCalendar();
            
            // 设置语言
            changeLanguage();
        }
        
        // 切换语言
        function changeLanguage() {
            currentLanguage = document.getElementById('languageSelect').value;
            
            // 更新所有文本
            for (const [key, value] of Object.entries(translations[currentLanguage])) {
                const element = document.getElementById(key);
                if (element) {
                    if (element.tagName === 'INPUT' && element.type === 'button') {
                        element.value = value;
                    } else {
                        element.textContent = value;
                    }
                }
            }
        }
        
        // 显示模态框
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }
        
        // 关闭模态框
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // 快速体验
        function quickLogin() {
            // 检查是否已有体验账号
            let quickUser = users.find(u => u.phone === '13800000000');
            if (!quickUser) {
                quickUser = {
                    id: 'quick_' + Date.now().toString(),
                    phone: '13800000000',
                    password: '123456',
                    inviteCode: 'QUICK' + Math.floor(1000 + Math.random() * 9000),
                    invitedBy: '',
                    balance: 0,
                    totalEarnings: 0,
                    withdrawn: 0,
                    simulators: 1,
                    lastCheckin: null,
                    todayEarnings: 0,
                    alipayAccount: null,
                    alipayName: null,
                    isAgent: false,
                    isPartner: false,
                    teamCount: 0,
                    isQuick: true,
                    isVip: false,
                    vipExpire: null,
                    hasCheckinBoost: false,
                    settings: {
                        autoCheckin: false,
                        autoWithdraw: false
                    },
                    items: []
                };
                users.push(quickUser);
            }
            
            currentUser = quickUser;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            closeModal('loginModal');
            updateUI();
            document.getElementById('mainContent').style.display = 'block';
            startEarningInterval();
            
            // 显示体验提示
            setTimeout(() => {
                alert(currentLanguage === 'zh' ? 
                    '您正在使用体验账号，数据将保存在本地浏览器中。注册正式账号可永久保存数据并获得更多功能！' : 
                    'You are using a trial account. Data will be saved in local browser. Register a formal account to save data permanently and get more features!');
            }, 500);
        }
        
        // 登录函数
        function login() {
            const phone = document.getElementById('loginPhone').value;
            const password = document.getElementById('loginPassword').value;
            const alertBox = document.getElementById('loginAlert');
            
            if (!phone || !password) {
                showAlert(alertBox, currentLanguage === 'zh' ? '请输入手机号和密码' : 'Please enter phone number and password', 'danger');
                return;
            }
            
            // 检查用户是否存在
            const user = users.find(u => u.phone === phone && u.password === password);
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                closeModal('loginModal');
                updateUI();
                document.getElementById('mainContent').style.display = 'block';
                startEarningInterval();
            } else {
                showAlert(alertBox, currentLanguage === 'zh' ? '手机号或密码错误' : 'Invalid phone number or password', 'danger');
            }
        }
        
        // 显示注册表单
        function showRegister() {
            closeModal('loginModal');
            showModal('registerModal');
        }
        
        // 注册函数
        function register() {
            const phone = document.getElementById('registerPhone').value;
            const password = document.getElementById('registerPassword').value;
            const password2 = document.getElementById('registerPassword2').value;
            const inviteCode = document.getElementById('inviteCode').value;
            const agreeTerms = document.getElementById('agreeTerms').checked;
            const alertBox = document.getElementById('registerAlert');
            
            // 验证输入
            if (!phone || !password || !password2) {
                showAlert(alertBox, currentLanguage === 'zh' ? '请填写所有必填项' : 'Please fill all required fields', 'danger');
                return;
            }
            
            if (password !== password2) {
                showAlert(alertBox, currentLanguage === 'zh' ? '两次输入的密码不一致' : 'Passwords do not match', 'danger');
                return;
            }
            
            if (password.length < 6) {
                showAlert(alertBox, currentLanguage === 'zh' ? '密码长度至少6位' : 'Password must be at least 6 characters', 'danger');
                return;
            }
            
            if (!agreeTerms) {
                showAlert(alertBox, currentLanguage === 'zh' ? '请阅读并同意用户协议' : 'Please agree to the terms', 'danger');
                return;
            }
            
            // 检查手机号是否已注册
            if (users.some(u => u.phone === phone)) {
                showAlert(alertBox, currentLanguage === 'zh' ? '该手机号已注册' : 'Phone number already registered', 'danger');
                return;
            }
            
            // 创建新用户
            const newUser = {
                id: Date.now().toString(),
                phone: phone,
                password: password,
                inviteCode: generateInviteCode(),
                invitedBy: inviteCode,
                balance: 0,
                totalEarnings: 0,
                withdrawn: 0,
                simulators: 1,
                lastCheckin: null,
                todayEarnings: 0,
                alipayAccount: null,
                alipayName: null,
                isAgent: false,
                isPartner: false,
                isVip: false,
                vipExpire: null,
                hasCheckinBoost: false,
                teamCount: 0,
                isQuick: false,
                settings: {
                    autoCheckin: false,
                    autoWithdraw: false
                },
                items: [],
                joinProjects: [],
                registerTime: new Date().toISOString(),
                checkinDays: 0,
                lastCheckinDate: null
            };
            
            users.push(newUser);
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // 如果有邀请人，给邀请人奖励
            if (inviteCode) {
                const inviter = users.find(u => u.inviteCode === inviteCode);
                if (inviter) {
                    inviter.simulators += 1;
                    inviter.teamCount += 1;
                    // 保存邀请人数据
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                }
            }
            
            showAlert(alertBox, currentLanguage === 'zh' ? '注册成功！' : 'Registration successful!', 'success');
            
            setTimeout(() => {
                closeModal('registerModal');
                updateUI();
                document.getElementById('mainContent').style.display = 'block';
                startEarningInterval();
            }, 1000);
        }
        
        // 显示提示信息
        function showAlert(element, message, type) {
            element.style.display = 'block';
            element.className = `alert alert-${type}`;
            element.innerHTML = message;
        }
        
        // 生成邀请码
        function generateInviteCode() {
            return Math.random().toString(36).substr(2, 6).toUpperCase();
        }
        
        // 更新UI
        function updateUI() {
            if (!currentUser) return;
            
            // 更新用户信息
            const phoneDisplay = currentUser.isQuick ? 
                (currentLanguage === 'zh' ? '体验账号' : 'Trial Account') : 
                `${currentUser.phone.substr(0, 3)}***${currentUser.phone.substr(7)}`;
            document.getElementById('userInfo').innerHTML = currentLanguage === 'zh' ? 
                `用户: ${phoneDisplay}` : `User: ${phoneDisplay}`;
            
            // 更新统计信息
            document.getElementById('userStats').innerHTML = `
                <p>${currentLanguage === 'zh' ? '已提现' : 'Withdrawn'}: ${currentUser.withdrawn.toFixed(2)}${currentLanguage === 'zh' ? '元' : '¥'}</p>
                <p>${currentLanguage === 'zh' ? '总收入' : 'Total Earnings'}: ${currentUser.totalEarnings.toFixed(2)}${currentLanguage === 'zh' ? '元' : '¥'}</p>
                <p>${currentLanguage === 'zh' ? '模拟器效率' : 'Efficiency'}: ${getEfficiencyMultiplier()}x</p>
            `;
            
            document.getElementById('simulatorCount').innerHTML = currentUser.simulators;
            document.getElementById('todayEarnings').innerHTML = currentUser.todayEarnings;
            
            const today = new Date().toDateString();
            const lastCheckinDate = currentUser.lastCheckinDate ? new Date(currentUser.lastCheckinDate).toDateString() : null;
            document.getElementById('checkinStatus').innerHTML = 
                lastCheckinDate === today ? (currentLanguage === 'zh' ? '已签到' : 'Checked-in') : (currentLanguage === 'zh' ? '未签到' : 'Not checked-in');
            
            // 更新模拟器列表
            let simulatorHtml = '';
            let onlineCount = 0;
            const isBoosted = simulatorBoostEndTime && new Date(simulatorBoostEndTime) > new Date();
            
            for (let i = 0; i < currentUser.simulators; i++) {
                const isOnline = Math.random() > 0.3;
                const isWorking = isOnline && Math.random() > 0.5;
                if (isOnline) onlineCount++;
                
                let statusClass = '';
                let statusText = '';
                
                if (!isOnline) {
                    statusClass = 'status-offline';
                    statusText = currentLanguage === 'zh' ? '离线' : 'Offline';
                } else if (isBoosted) {
                    statusClass = 'status-boosted';
                    statusText = currentLanguage === 'zh' ? '加速中' : 'Boosted';
                } else if (isWorking) {
                    statusClass = 'status-working';
                    statusText = currentLanguage === 'zh' ? '工作中' : 'Working';
                } else {
                    statusClass = 'status-online';
                    statusText = currentLanguage === 'zh' ? '在线' : 'Online';
                }
                
                simulatorHtml += `
                    <div class="task-item">
                        <div class="task-info">${currentLanguage === 'zh' ? '手机模拟器' : 'Simulator'} ${i+1}</div>
                        <div class="simulator-status ${statusClass}">
                            ${statusText}
                        </div>
                        <button class="btn btn-small" onclick="restartSimulator(${i})">${currentLanguage === 'zh' ? '重启' : 'Restart'}</button>
                    </div>
                `;
            }
            document.getElementById('simulatorList').innerHTML = simulatorHtml;
            document.getElementById('onlineSimulators').innerHTML = `${onlineCount}/${currentUser.simulators}${currentLanguage === 'zh' ? '在线' : 'Online'}`;
            
            // 更新账户信息
            document.getElementById('accountInfo').innerHTML = `
                <p>${currentLanguage === 'zh' ? '手机号' : 'Phone'}: ${currentUser.phone}</p>
                <p>${currentLanguage === 'zh' ? '注册时间' : 'Register Time'}: ${new Date(currentUser.registerTime).toLocaleDateString()}</p>
                <p>${currentLanguage === 'zh' ? '团队人数' : 'Team Members'}: ${currentUser.teamCount}</p>
                <p>${currentLanguage === 'zh' ? '身份' : 'Status'}: ${currentUser.isPartner ? 
                    (currentLanguage === 'zh' ? '合伙人' : 'Partner') : 
                    currentUser.isAgent ? (currentLanguage === 'zh' ? '代理' : 'Agent') : 
                    currentUser.isVip ? 'VIP' : (currentLanguage === 'zh' ? '普通用户' : 'Normal User')}</p>
                <p>${currentLanguage === 'zh' ? '连续签到' : 'Check-in Days'}: ${currentUser.checkinDays || 0}${currentLanguage === 'zh' ? '天' : 'days'}</p>
                ${currentUser.isVip ? `<p>VIP ${currentLanguage === 'zh' ? '到期' : 'Expire'}: ${new Date(currentUser.vipExpire).toLocaleDateString()}</p>` : ''}
            `;
            
            // 更新支付宝信息
            if (currentUser.alipayAccount) {
                document.getElementById('alipayInfo').innerHTML = `
                    <p>${currentLanguage === 'zh' ? '支付宝账号' : 'Alipay Account'}: ${currentUser.alipayAccount}</p>
                    <p>${currentLanguage === 'zh' ? '实名姓名' : 'Real Name'}: ${currentUser.alipayName}</p>
                `;
                document.getElementById('bindAlipayBtn').innerHTML = currentLanguage === 'zh' ? '修改绑定' : 'Change Binding';
            } else {
                document.getElementById('alipayInfo').innerHTML = `<p>${currentLanguage === 'zh' ? '未绑定支付宝' : 'Alipay not bound'}</p>`;
                document.getElementById('bindAlipayBtn').innerHTML = currentLanguage === 'zh' ? '绑定支付宝' : 'Bind Alipay';
            }
            
            // 更新邀请信息
            document.getElementById('inviteInfo').innerHTML = `
                <p>${currentLanguage === 'zh' ? '您的邀请码' : 'Your Invite Code'}: ${currentUser.inviteCode}</p>
                <p>${currentLanguage === 'zh' ? '已邀请好友' : 'Invited Friends'}: ${currentUser.teamCount}${currentLanguage === 'zh' ? '人' : ''}</p>
                <p>${currentLanguage === 'zh' ? '邀请奖励' : 'Invite Rewards'}: ${currentUser.teamCount * 10}${currentLanguage === 'zh' ? '元' : '¥'}</p>
            `;
            
            // 更新收益统计
            document.getElementById('earningsStats').innerHTML = `
                <p>${currentLanguage === 'zh' ? '今日收益' : "Today's Earnings"}: ${currentUser.todayEarnings}${currentLanguage === 'zh' ? '金币' : 'coins'}</p>
                <p>${currentLanguage === 'zh' ? '可提现余额' : 'Withdrawable Balance'}: ${currentUser.balance.toFixed(2)}${currentLanguage === 'zh' ? '元' : '¥'}</p>
                <p>${currentLanguage === 'zh' ? '累计收益' : 'Total Earnings'}: ${currentUser.totalEarnings.toFixed(2)}${currentLanguage === 'zh' ? '元' : '¥'}</p>
                <p>${currentLanguage === 'zh' ? '待结算' : 'Pending'}: ${(currentUser.todayEarnings / 10000).toFixed(2)}${currentLanguage === 'zh' ? '元' : '¥'}</p>
            `;
            
            // 更新提现记录
            renderWithdrawHistory();
            
            // 更新商城道具
            renderMyItems();
            
            // 更新设置
            if (currentUser.settings) {
                document.getElementById('autoCheckin').checked = currentUser.settings.autoCheckin || false;
                document.getElementById('autoWithdraw').checked = currentUser.settings.autoWithdraw || false;
            }
            
            // 更新VIP任务显示
            document.getElementById('vipTask').style.display = currentUser.isVip ? 'flex' : 'none';
            
            // 更新签到翻倍按钮状态
            document.getElementById('checkinBoostBtn').disabled = !currentUser.hasCheckinBoost;
            
            // 更新加速按钮状态
            const isBoostActive = simulatorBoostEndTime && new Date(simulatorBoostEndTime) > new Date();
            document.getElementById('boostBtn').disabled = isBoostActive;
            if (isBoostActive) {
                const remaining = Math.ceil((new Date(simulatorBoostEndTime) - new Date()) / 1000 / 60);
                document.getElementById('boostBtn').textContent = 
                    currentLanguage === 'zh' ? `加速中 (剩余${remaining}分钟)` : `Boosted (${remaining}min left)`;
            }
        }
        
        // 渲染提现记录
        function renderWithdrawHistory() {
            let historyHtml = '';
            const userHistory = withdrawHistory.filter(w => w.userId === currentUser.id);
            
            if (userHistory.length === 0) {
                historyHtml = `<p>${currentLanguage === 'zh' ? '暂无提现记录' : 'No withdrawal history'}</p>`;
            } else {
                userHistory.forEach(record => {
                    historyHtml += `
                        <div class="task-item">
                            <div class="task-info">${new Date(record.time).toLocaleString()}</div>
                            <div class="task-reward">${record.amount.toFixed(2)}${currentLanguage === 'zh' ? '元' : '¥'}</div>
                            <div class="simulator-status ${record.status === 'completed' ? 'status-online' : 'status-working'}">
                                ${record.status === 'completed' ? (currentLanguage === 'zh' ? '已完成' : 'Completed') : (currentLanguage === 'zh' ? '处理中' : 'Processing')}
                            </div>
                        </div>
                    `;
                });
            }
            document.getElementById('withdrawHistory').innerHTML = historyHtml;
        }
        
        // 渲染我的道具
        function renderMyItems() {
            let itemsHtml = '';
            if (!currentUser.items || currentUser.items.length === 0) {
                itemsHtml = `<p>${currentLanguage === 'zh' ? '暂无道具' : 'No items'}</p>`;
            } else {
                currentUser.items.forEach(item => {
                    if (item.expireTime && new Date(item.expireTime) < new Date()) return;
                    
                    let itemInfo = '';
                    if (item.type === 'card') {
                        const expireDate = item.expireTime ? new Date(item.expireTime).toLocaleDateString() : (currentLanguage === 'zh' ? '永久' : 'Permanent');
                        itemInfo = `${currentLanguage === 'zh' ? '效率+' : 'Efficiency+' }${item.value*100}% (${currentLanguage === 'zh' ? '到期' : 'Expire'}: ${expireDate})`;
                    } else if (item.type === 'simulator') {
                        itemInfo = `${currentLanguage === 'zh' ? '效率' : 'Efficiency'}: ${item.value}${currentLanguage === 'zh' ? '金币/分钟' : 'coins/min'}`;
                    } else if (item.type === 'boost' && item.subtype === 'checkin') {
                        itemInfo = currentLanguage === 'zh' ? '下次签到奖励翻倍' : 'Double next check-in reward';
                    }
                    
                    itemsHtml += `
                        <div class="task-item">
                            <div class="task-info">${item.name}</div>
                            <div class="simulator-status">${itemInfo}</div>
                        </div>
                    `;
                });
            }
            document.getElementById('myItems').innerHTML = itemsHtml;
        }
        
        // 获取效率倍数
        function getEfficiencyMultiplier() {
            let multiplier = 1;
            if (!currentUser.items) return multiplier;
            
            // 检查加速状态
            const isBoosted = simulatorBoostEndTime && new Date(simulatorBoostEndTime) > new Date();
            if (isBoosted) {
                multiplier *= 2; // 加速期间效率翻倍
            }
            
            // VIP加成
            if (currentUser.isVip) {
                multiplier *= 1.5; // VIP用户获得50%加成
            }
            
            // 道具加成
            currentUser.items.forEach(item => {
                if (item.type === 'card' && (!item.expireTime || new Date(item.expireTime) > new Date())) {
                    multiplier += item.value;
                }
            });
            
            // 代理加成
            if (currentUser.isAgent) multiplier += 0.2;
            if (currentUser.isPartner) multiplier += 0.5;
            
            return multiplier.toFixed(1);
        }
        
        // 渲染任务列表
        function renderTaskList() {
            let taskHtml = '';
            tasks.forEach(task => {
                taskHtml += `
                    <div class="task-item">
                        <div class="task-info">${task.name}</div>
                        <div class="task-reward">+${task.reward}${currentLanguage === 'zh' ? '金币' : 'coins'}</div>
                        <button class="btn btn-small" onclick="completeTask(${task.id})" ${task.completed ? 'disabled' : ''}>
                            ${task.completed ? (currentLanguage === 'zh' ? '已完成' : 'Completed') : (currentLanguage === 'zh' ? '去做任务' : 'Do Task')}
                        </button>
                    </div>
                `;
            });
            document.getElementById('taskList').innerHTML = taskHtml;
        }
        
        // 渲染签到日历
        function renderCheckinCalendar() {
            const calendarHtml = `
                <div style="display: flex; flex-wrap: wrap; justify-content: space-between;">
                    ${Array.from({length: 7}, (_, i) => {
                        const day = i + 1;
                        const isChecked = currentUser.checkinDays >= day;
                        return `
                            <div style="width: 14%; text-align: center; padding: 5px; 
                                background: ${isChecked ? '#4CAF50' : '#f5f5f5'}; 
                                color: ${isChecked ? 'white' : '#333'};
                                border-radius: 5px; margin: 1px;">
                                ${currentLanguage === 'zh' ? '第' : 'Day '}${day}${currentLanguage === 'zh' ? '天' : ''}
                            </div>
                        `;
                    }).join('')}
                </div>
                <p style="font-size: 12px; margin-top: 10px;">
                    ${currentLanguage === 'zh' ? '连续签到7天可获得5元现金奖励' : 'Check in for 7 consecutive days to get ¥5 reward'}
                </p>
            `;
            document.getElementById('checkinCalendar').innerHTML = calendarHtml;
        }
        
        // 完成任务
        function completeTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (!task || task.completed) return;
            
            task.completed = true;
            currentUser.todayEarnings += task.reward;
            currentUser.balance += task.reward / 10000; // 假设10000金币=1元
            currentUser.totalEarnings += task.reward / 10000;
            
            // 保存更新
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // 更新UI
            renderTaskList();
            updateUI();
            
            // 模拟任务完成后的延迟
            setTimeout(() => {
                task.completed = false;
                renderTaskList();
                
                // 如果开启了自动完成任务，则自动再次完成任务
                if (autoCompleteTasks) {
                    setTimeout(() => completeTask(taskId), 1000);
                }
            }, task.time * 60 * 1000); // 转换为毫秒
        }
        
        // 每日签到
        function dailyCheckin() {
            const today = new Date();
            const todayStr = today.toDateString();
            const lastCheckinDate = currentUser.lastCheckinDate ? new Date(currentUser.lastCheckinDate).toDateString() : null;
            
            // 检查是否已签到
            if (lastCheckinDate === todayStr) {
                alert(currentLanguage === 'zh' ? '今天已经签到过了' : 'Already checked in today');
                return;
            }
            
            // 检查是否连续签到
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toDateString();
            
            if (lastCheckinDate === yesterdayStr) {
                currentUser.checkinDays = (currentUser.checkinDays || 0) + 1;
            } else {
                currentUser.checkinDays = 1;
            }
            
            let reward = 1000 + currentUser.checkinDays * 100; // 基础奖励+连续签到额外奖励
            
            // 检查是否有签到翻倍卡
            if (currentUser.hasCheckinBoost) {
                reward *= 2;
                currentUser.hasCheckinBoost = false;
                alert(currentLanguage === 'zh' ? '签到奖励已翻倍！' : 'Check-in reward doubled!');
            }
            
            // VIP用户签到奖励增加
            if (currentUser.isVip) {
                reward *= 1.5;
            }
            
            currentUser.lastCheckin = new Date();
            currentUser.lastCheckinDate = today.toISOString();
            currentUser.todayEarnings += reward;
            currentUser.balance += reward / 10000;
            currentUser.totalEarnings += reward / 10000;
            
            // 检查连续签到奖励
            let bonusMessage = '';
            if (currentUser.checkinDays % 7 === 0) {
                const bonus = 50000; // 7天奖励5元(50000金币)
                currentUser.balance += bonus / 10000;
                currentUser.totalEarnings += bonus / 10000;
                bonusMessage = currentLanguage === 'zh' ? `和连续7天签到奖励${bonus}金币` : `and 7-day streak bonus ${bonus} coins`;
            }
            
            // 随机获得模拟器
            if (Math.random() > 0.7) {
                currentUser.simulators += 1;
                alert(currentLanguage === 'zh' ? 
                    `签到成功！获得${reward}金币${bonusMessage}和1个模拟器` : 
                    `Check-in successful! Got ${reward} coins${bonusMessage} and 1 simulator`);
            } else {
                alert(currentLanguage === 'zh' ? 
                    `签到成功！获得${reward}金币${bonusMessage}` : 
                    `Check-in successful! Got ${reward} coins${bonusMessage}`);
            }
            
            // 保存更新
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            renderCheckinCalendar();
        }
        
        // 添加模拟器
        function addSimulator() {
            if (currentUser.isQuick) {
                alert(currentLanguage === 'zh' ? 
                    '体验账号无法添加模拟器，请注册正式账号' : 
                    'Trial account cannot add simulators, please register');
                return;
            }
            
            alert(currentLanguage === 'zh' ? 
                '通过推广好友或完成任务可以获得更多模拟器' : 
                'Get more simulators by inviting friends or completing tasks');
        }
        
        // 重启模拟器
        function restartSimulator(index) {
            alert(currentLanguage === 'zh' ? 
                `正在重启模拟器${index + 1}...` : 
                `Restarting simulator ${index + 1}...`);
            // 模拟重启过程
            setTimeout(() => {
                alert(currentLanguage === 'zh' ? 
                    `模拟器${index + 1}重启成功` : 
                    `Simulator ${index + 1} restarted successfully`);
            }, 2000);
        }
        
        // 优化模拟器
        function optimizeSimulators() {
            alert(currentLanguage === 'zh' ? 
                '正在优化所有模拟器性能...' : 
                'Optimizing all simulators...');
            // 模拟优化过程
            setTimeout(() => {
                alert(currentLanguage === 'zh' ? 
                    '优化完成！模拟器效率提升10%' : 
                    'Optimization complete! Simulator efficiency increased by 10%');
                // 这里可以添加实际的优化效果
                updateUI();
            }, 3000);
        }
        
        // 新增：加速模拟器
        function boostSimulators() {
            if (currentUser.isQuick) {
                alert(currentLanguage === 'zh' ? 
                    '体验账号无法使用加速功能' : 
                    'Trial account cannot use boost feature');
                return;
            }
            
            // 设置加速结束时间（1小时后）
            simulatorBoostEndTime = new Date(Date.now() + 60 * 60 * 1000).toISOString();
            
            alert(currentLanguage === 'zh' ? 
                '模拟器已加速！1小时内收益翻倍' : 
                'Simulators boosted! Double earnings for 1 hour');
            
            updateUI();
            
            // 1小时后自动取消加速
            setTimeout(() => {
                simulatorBoostEndTime = null;
                updateUI();
                alert(currentLanguage === 'zh' ? 
                    '模拟器加速已结束' : 
                    'Simulator boost has ended');
            }, 60 * 60 * 1000);
        }
        
        // 升级代理
        function upgradeAgent() {
            if (currentUser.isAgent) {
                alert(currentLanguage === 'zh' ? '您已经是代理了' : 'You are already an agent');
                return;
            }
            
            if (currentUser.teamCount < 5) {
                alert(currentLanguage === 'zh' ? 
                    '需要邀请至少5位好友才能升级为代理' : 
                    'Need to invite at least 5 friends to upgrade to agent');
                return;
            }
            
            if (currentUser.balance < 50) {
                alert(currentLanguage === 'zh' ? '升级代理需要50元费用' : 'Agent upgrade requires ¥50');
                return;
            }
            
            currentUser.isAgent = true;
            currentUser.balance -= 50;
            currentUser.simulators += 3; // 代理奖励3个模拟器
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            alert(currentLanguage === 'zh' ? 
                '恭喜您升级为代理！获得3个额外模拟器和20%收益加成' : 
                'Congratulations! You are now an agent. Got 3 extra simulators and 20% earnings bonus');
        }
        
        // 新增：购买VIP会员
        function purchaseVIP() {
            if (currentUser.isVip && new Date(currentUser.vipExpire) > new Date()) {
                alert(currentLanguage === 'zh' ? 
                    '您已经是VIP会员' : 
                    'You are already a VIP member');
                return;
            }
            
            if (currentUser.balance < 30) {
                alert(currentLanguage === 'zh' ? 
                    '余额不足，开通VIP需要30元' : 
                    'Insufficient balance, VIP requires ¥30');
                return;
            }
            
            currentUser.balance -= 30;
            currentUser.isVip = true;
            
            // 设置VIP到期时间（30天后）
            const expireDate = new Date();
            expireDate.setDate(expireDate.getDate() + 30);
            currentUser.vipExpire = expireDate.toISOString();
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            
            alert(currentLanguage === 'zh' ? 
                '恭喜您成为VIP会员！享受50%收益加成和其他特权' : 
                'Congratulations! You are now a VIP member. Enjoy 50% earnings bonus and other privileges');
        }
        
        // 新增：购买签到翻倍卡
        function buyCheckinBoost() {
            if (currentUser.balance < 8) {
                alert(currentLanguage === 'zh' ? 
                    '余额不足，购买签到翻倍卡需要8元' : 
                    'Insufficient balance, check-in boost card costs ¥8');
                return;
            }
            
            currentUser.balance -= 8;
            currentUser.hasCheckinBoost = true;
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            
            alert(currentLanguage === 'zh' ? 
                '购买成功！下次签到奖励将翻倍' : 
                'Purchase successful! Next check-in reward will be doubled');
        }
        
        // 新增：使用签到翻倍卡
        function useCheckinBoost() {
            if (!currentUser.hasCheckinBoost) {
                alert(currentLanguage === 'zh' ? 
                    '您没有签到翻倍卡' : 
                    'You don\'t have a check-in boost card');
                return;
            }
            
            currentUser.hasCheckinBoost = true;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            
            alert(currentLanguage === 'zh' ? 
                '已激活签到翻倍卡，下次签到奖励将翻倍' : 
                'Check-in boost activated, next check-in reward will be doubled');
        }
        
        // 新增：切换任务自动完成
        function toggleAutoCompleteTasks() {
            autoCompleteTasks = document.getElementById('autoCompleteTasks').checked;
            
            if (autoCompleteTasks) {
                // 自动完成所有未完成任务
                tasks.forEach(task => {
                    if (!task.completed) {
                        completeTask(task.id);
                    }
                });
                
                alert(currentLanguage === 'zh' ? 
                    '已开启任务自动完成' : 
                    'Auto complete tasks enabled');
            }
        }
        
        // 显示支付宝绑定模态框
        function showAlipayModal() {
            showModal('alipayModal');
            document.getElementById('alipayAlert').style.display = 'none';
            document.getElementById('alipayAccount').value = currentUser.alipayAccount || '';
            document.getElementById('alipayName').value = currentUser.alipayName || '';
        }
        
        // 绑定支付宝
        function bindAlipay() {
            const account = document.getElementById('alipayAccount').value;
            const name = document.getElementById('alipayName').value;
            const alertBox = document.getElementById('alipayAlert');
            
            if (!account || !name) {
                showAlert(alertBox, currentLanguage === 'zh' ? '请输入支付宝账号和姓名' : 'Please enter Alipay account and name', 'danger');
                return;
            }
            
            // 检查支付宝是否已被绑定
            if (alipayBindings.includes(account) && (!currentUser.alipayAccount || currentUser.alipayAccount !== account)) {
                showAlert(alertBox, currentLanguage === 'zh' ? '该支付宝账号已被其他账号绑定' : 'This Alipay account is already bound', 'danger');
                return;
            }
            
            // 更新绑定
            if (currentUser.alipayAccount && currentUser.alipayAccount !== account) {
                // 移除旧绑定
                const index = alipayBindings.indexOf(currentUser.alipayAccount);
                if (index > -1) {
                    alipayBindings.splice(index, 1);
                }
            }
            
            currentUser.alipayAccount = account;
            currentUser.alipayName = name;
            alipayBindings.push(account);
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            showAlert(alertBox, currentLanguage === 'zh' ? '支付宝绑定成功' : 'Alipay binding successful', 'success');
            
            setTimeout(() => {
                closeModal('alipayModal');
                updateUI();
            }, 1000);
        }
        
        // 提现
        function withdraw() {
            if (!currentUser.alipayAccount) {
                alert(currentLanguage === 'zh' ? '请先绑定支付宝账号' : 'Please bind Alipay account first');
                showAlipayModal();
                return;
            }
            
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            
            if (currentUser.balance < amount) {
                alert(currentLanguage === 'zh' ? '余额不足' : 'Insufficient balance');
                return;
            }
            
            if (amount < 10) {
                alert(currentLanguage === 'zh' ? '最低提现金额为10元' : 'Minimum withdrawal amount is ¥10');
                return;
            }
            
            currentUser.balance -= amount;
            currentUser.withdrawn += amount;
            
            // 记录提现历史
            const withdrawRecord = {
                id: Date.now().toString(),
                userId: currentUser.id,
                amount: amount,
                time: new Date().toISOString(),
                status: 'pending',
                alipayAccount: currentUser.alipayAccount
            };
            
            withdrawHistory.push(withdrawRecord);
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // 模拟提现处理
            setTimeout(() => {
                const record = withdrawHistory.find(w => w.id === withdrawRecord.id);
                if (record) {
                    record.status = 'completed';
                    alert(currentLanguage === 'zh' ? 
                        `提现成功，${amount}元已打入您的支付宝账户` : 
                        `Withdrawal successful, ¥${amount} has been transferred to your Alipay account`);
                    updateUI();
                }
            }, 5000);
            
            alert(currentLanguage === 'zh' ? 
                `提现申请已提交，${amount}元将在24小时内打入您的支付宝账户` : 
                `Withdrawal request submitted, ¥${amount} will be transferred within 24 hours`);
            updateUI();
        }
        
        // 金币兑换
        function exchangeGold() {
            const goldInput = document.getElementById('exchangeGold');
            const gold = parseInt(goldInput.value);
            
            if (isNaN(gold) || gold < 10000) {
                alert(currentLanguage === 'zh' ? 
                    '最低兑换10000金币(1元)' : 
                    'Minimum exchange is 10000 coins (¥1)');
                return;
            }
            
            if (currentUser.todayEarnings < gold) {
                alert(currentLanguage === 'zh' ? '今日收益不足' : 'Insufficient earnings today');
                return;
            }
            
            currentUser.todayEarnings -= gold;
            currentUser.balance += gold / 10000;
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            alert(currentLanguage === 'zh' ? 
                `成功兑换${gold}金币为${gold/10000}元` : 
                `Successfully exchanged ${gold} coins for ¥${gold/10000}`);
            goldInput.value = '';
        }
        
        // 显示邀请模态框
        function showInvite() {
            showModal('inviteModal');
            document.getElementById('myInviteCode').value = currentUser.inviteCode;
            document.getElementById('inviteLink').value = `${window.location.href.split('?')[0]}?invite=${currentUser.inviteCode}`;
        }
        
        // 查看团队
        function viewTeam() {
            showModal('teamModal');
            
            let teamHtml = '';
            const teamMembers = users.filter(u => u.invitedBy === currentUser.inviteCode);
            
            if (teamMembers.length === 0) {
                teamHtml = `<p>${currentLanguage === 'zh' ? '暂无团队成员' : 'No team members'}</p>`;
            } else {
                teamMembers.forEach(member => {
                    teamHtml += `
                        <div class="task-item">
                            <div class="task-info">${member.phone.substr(0, 3)}***${member.phone.substr(7)}</div>
                            <div class="task-reward">${member.simulators}${currentLanguage === 'zh' ? '模拟器' : 'simulators'}</div>
                            <div class="simulator-status">${new Date(member.registerTime).toLocaleDateString()}</div>
                        </div>
                    `;
                });
            }
            
            document.getElementById('teamList').innerHTML = teamHtml;
            document.getElementById('teamCount').innerHTML = teamMembers.length;
            
            const teamEarnings = teamMembers.reduce((sum, member) => sum + member.totalEarnings * 0.1, 0);
            document.getElementById('teamEarnings').innerHTML = teamEarnings.toFixed(2);
        }
        
        // 分享邀请
        function shareInvite() {
            alert(currentLanguage === 'zh' ? 
                '邀请链接已复制，可以粘贴到微信、QQ等社交平台' : 
                'Invite link copied, you can share it on social media');
            copyInviteLink();
        }
        
        // 复制邀请链接
        function copyInviteLink() {
            const inviteLink = document.getElementById('inviteLink');
            inviteLink.select();
            document.execCommand('copy');
            alert(currentLanguage === 'zh' ? '邀请链接已复制到剪贴板' : 'Invite link copied to clipboard');
        }
        
        // 加入项目
        function joinProject(projectId) {
            if (!currentUser.joinProjects) {
                currentUser.joinProjects = [];
            }
            
            if (currentUser.joinProjects.includes(projectId)) {
                alert(currentLanguage === 'zh' ? '您已加入该项目' : 'You already joined this project');
                return;
            }
            
            currentUser.joinProjects.push(projectId);
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            let projectName = '';
            switch(projectId) {
                case 1: projectName = currentLanguage === 'zh' ? '一键拉新日赚500' : 'Easy Invite Earn ¥500'; break;
                case 2: projectName = currentLanguage === 'zh' ? 'AI慧算宝简单分红' : 'AI Profit Sharing'; break;
                case 3: projectName = currentLanguage === 'zh' ? '视频号挂机' : 'Video Channel AFK'; break;
            }
            
            alert(currentLanguage === 'zh' ? 
                `成功加入${projectName}项目，收益将自动计算` : 
                `Successfully joined ${projectName} project, earnings will be calculated automatically`);
        }
        
        // 开始高级任务
        function startAdvancedTask(taskId) {
            const task = advancedTasks.find(t => t.id === taskId);
            if (!task) return;
            
            currentAdvancedTask = {
                ...task,
                startTime: new Date(),
                progress: 0
            };
            
            showModal('advancedTaskModal');
            document.getElementById('advancedTaskTitle').innerHTML = task.name;
            document.getElementById('taskInstructions').innerHTML = task.instructions;
            document.getElementById('taskCompleteBtn').style.display = 'none';
            
            // 更新进度条
            updateTaskProgress();
            
            // 开始计时
            taskInterval = setInterval(updateTaskProgress, 1000);
        }
        
        // 新增：开始VIP任务
        function startVipTask() {
            if (!currentUser.isVip) {
                alert(currentLanguage === 'zh' ? 
                    '此任务仅限VIP会员' : 
                    'This task is for VIP members only');
                return;
            }
            
            const task = {
                id: 4,
                name: currentLanguage === 'zh' ? 'VIP专属任务 - 观看广告' : 'VIP Task - Watch Ad',
                reward: 150000,
                time: 5,
                instructions: currentLanguage === 'zh' ? '请观看完整广告视频以获得奖励' : 'Please watch the full ad video to get reward'
            };
            
            currentAdvancedTask = {
                ...task,
                startTime: new Date(),
                progress: 0
            };
            
            showModal('advancedTaskModal');
            document.getElementById('advancedTaskTitle').innerHTML = task.name;
            document.getElementById('taskInstructions').innerHTML = task.instructions;
            document.getElementById('taskCompleteBtn').style.display = 'none';
            
            // 更新进度条
            updateTaskProgress();
            
            // 开始计时
            taskInterval = setInterval(updateTaskProgress, 1000);
        }
        
        // 更新任务进度
        function updateTaskProgress() {
            if (!currentAdvancedTask) return;
            
            const now = new Date();
            const elapsed = (now - currentAdvancedTask.startTime) / 1000 / 60; // 分钟
            currentAdvancedTask.progress = Math.min(elapsed / currentAdvancedTask.time * 100, 100);
            
            document.getElementById('taskProgress').style.width = `${currentAdvancedTask.progress}%`;
            
            const remaining = currentAdvancedTask.time * 60 - Math.floor(elapsed * 60);
            const minutes = Math.floor(remaining / 60);
            const seconds = remaining % 60;
            document.getElementById('taskTime').innerHTML = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            if (currentAdvancedTask.progress >= 100) {
                clearInterval(taskInterval);
                document.getElementById('taskCompleteBtn').style.display = 'block';
                document.getElementById('taskCancelBtn').style.display = 'none';
            }
        }
        
        // 完成高级任务
        function completeAdvancedTask() {
            if (!currentAdvancedTask) return;
            
            currentUser.todayEarnings += currentAdvancedTask.reward;
            currentUser.balance += currentAdvancedTask.reward / 10000;
            currentUser.totalEarnings += currentAdvancedTask.reward / 10000;
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            
            alert(currentLanguage === 'zh' ? 
                `任务完成！获得${currentAdvancedTask.reward}金币奖励` : 
                `Task completed! Got ${currentAdvancedTask.reward} coins reward`);
            closeModal('advancedTaskModal');
            currentAdvancedTask = null;
        }
        
        // 取消高级任务
        function cancelAdvancedTask() {
            if (taskInterval) clearInterval(taskInterval);
            currentAdvancedTask = null;
            closeModal('advancedTaskModal');
            alert(currentLanguage === 'zh' ? '已取消任务' : 'Task canceled');
        }
        
        // 关闭高级任务
        function closeAdvancedTask() {
            if (taskInterval) clearInterval(taskInterval);
            currentAdvancedTask = null;
            closeModal('advancedTaskModal');
        }
        
        // 购买模拟器
        function buySimulator(type) {
            const item = shopItems.find(i => i.id === type && i.type === 'simulator');
            if (!item) return;
            
            if (currentUser.balance < item.price) {
                alert(currentLanguage === 'zh' ? 
                    `余额不足，需要${item.price}元` : 
                    `Insufficient balance, need ¥${item.price}`);
                return;
            }
            
            currentUser.balance -= item.price;
            currentUser.simulators += 1;
            
            // 添加到道具列表
            if (!currentUser.items) currentUser.items = [];
            currentUser.items.push({
                id: Date.now().toString(),
                type: 'simulator',
                name: item.name,
                value: item.value,
                buyTime: new Date().toISOString()
            });
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            alert(currentLanguage === 'zh' ? 
                `购买成功！获得1个${item.name}` : 
                `Purchase successful! Got 1 ${item.name}`);
        }
        
        // 购买特权卡
        function buyCard(type) {
            const item = shopItems.find(i => i.id === type + 3 && i.type === 'card');
            if (!item) return;
            
            if (currentUser.balance < item.price) {
                alert(currentLanguage === 'zh' ? 
                    `余额不足，需要${item.price}元` : 
                    `Insufficient balance, need ¥${item.price}`);
                return;
            }
            
            currentUser.balance -= item.price;
            
            // 计算到期时间
            const expireTime = new Date();
            expireTime.setDate(expireTime.getDate() + item.duration);
            
            // 添加到道具列表
            if (!currentUser.items) currentUser.items = [];
            currentUser.items.push({
                id: Date.now().toString(),
                type: 'card',
                name: item.name,
                value: item.value,
                buyTime: new Date().toISOString(),
                expireTime: expireTime.toISOString()
            });
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            alert(currentLanguage === 'zh' ? 
                `购买成功！${item.name}已生效，有效期${item.duration}天` : 
                `Purchase successful! ${item.name} activated, valid for ${item.duration} days`);
        }
        
        // 新增：购买签到翻倍卡
        function buyCheckinBoost() {
            const item = shopItems.find(i => i.id === 7 && i.type === 'boost');
            if (!item) return;
            
            if (currentUser.balance < item.price) {
                alert(currentLanguage === 'zh' ? 
                    `余额不足，需要${item.price}元` : 
                    `Insufficient balance, need ¥${item.price}`);
                return;
            }
            
            currentUser.balance -= item.price;
            currentUser.hasCheckinBoost = true;
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            alert(currentLanguage === 'zh' ? 
                '购买成功！下次签到奖励将翻倍' : 
                'Purchase successful! Next check-in reward will be doubled');
        }
        
        // 保存设置
        function saveSettings() {
            if (!currentUser.settings) currentUser.settings = {};
            
            currentUser.settings.autoCheckin = document.getElementById('autoCheckin').checked;
            currentUser.settings.autoWithdraw = document.getElementById('autoWithdraw').checked;
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            alert(currentLanguage === 'zh' ? '设置已保存' : 'Settings saved');
        }
        
        // 切换标签页
        function switchTab(tabName) {
            // 更新导航标签
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // 更新内容区域
            const tabContainers = document.querySelectorAll('.tab-container');
            tabContainers.forEach(container => container.classList.remove('active'));
            document.getElementById(`${tabName}Tab`).classList.add('active');
        }
        
        // 退出登录
        function logout() {
            if (taskInterval) clearInterval(taskInterval);
            if (earningInterval) clearInterval(earningInterval);
            if (countdownInterval) clearInterval(countdownInterval);
            
            currentUser = null;
            localStorage.removeItem('currentUser');
            document.getElementById('mainContent').style.display = 'none';
            showModal('loginModal');
        }
        
        // 开始收益计时器
        function startEarningInterval() {
            if (earningInterval) clearInterval(earningInterval);
            if (countdownInterval) clearInterval(countdownInterval);
            
            nextEarningTime = 60;
            updateEarningCountdown();
            
            // 每分钟计算一次收益
            earningInterval = setInterval(calculateEarnings, 60000);
            
            // 每秒更新倒计时
            countdownInterval = setInterval(updateEarningCountdown, 1000);
        }
        
        // 计算收益
        function calculateEarnings() {
            if (!currentUser) return;
            
            const efficiency = getEfficiencyMultiplier();
            const earnings = currentUser.simulators * 1 * efficiency; // 每个模拟器每分钟1金币乘以效率
            
            currentUser.todayEarnings += earnings;
            currentUser.balance += earnings / 10000;
            currentUser.totalEarnings += earnings / 10000;
            
            // 检查自动提现
            if (currentUser.settings?.autoWithdraw && currentUser.balance >= 10 && currentUser.alipayAccount) {
                currentUser.balance -= 10;
                currentUser.withdrawn += 10;
                
                const withdrawRecord = {
                    id: Date.now().toString(),
                    userId: currentUser.id,
                    amount: 10,
                    time: new Date().toISOString(),
                    status: 'pending',
                    alipayAccount: currentUser.alipayAccount
                };
                
                withdrawHistory.push(withdrawRecord);
                
                // 模拟提现处理
                setTimeout(() => {
                    const record = withdrawHistory.find(w => w.id === withdrawRecord.id);
                    if (record) {
                        record.status = 'completed';
                        updateUI();
                    }
                }, 5000);
            }
            
            // 检查自动签到
            if (currentUser.settings?.autoCheckin) {
                const today = new Date().toDateString();
                const lastCheckinDate = currentUser.lastCheckinDate ? new Date(currentUser.lastCheckinDate).toDateString() : null;
                
                if (lastCheckinDate !== today) {
                    dailyCheckin();
                }
            }
            
            // 检查VIP是否到期
            if (currentUser.isVip && new Date(currentUser.vipExpire) < new Date()) {
                currentUser.isVip = false;
                alert(currentLanguage === 'zh' ? 
                    '您的VIP会员已到期' : 
                    'Your VIP membership has expired');
            }
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            
            nextEarningTime = 60;
            document.getElementById('earningProgress').style.width = '0%';
        }
        
        // 更新收益倒计时
        function updateEarningCountdown() {
            if (!currentUser) return;
            
            nextEarningTime--;
            document.getElementById('nextEarningTime').innerHTML = nextEarningTime;
            
            const progress = (60 - nextEarningTime) / 60 * 100;
            document.getElementById('earningProgress').style.width = `${progress}%`;
            
            if (nextEarningTime <= 0) {
                nextEarningTime = 60;
            }
        }
        
        // 页面加载时初始化
        window.onload = init;
    </script>
</body>
</html>
